var canvas = document.getElementById("daily_canvas");
var cxt = canvas.getContext('2d');
var canWidth = cxt.canvas.clientWidth;
var init = {top: 32, spaceH: 70};
var row4 = {
    data:[
        {
            type:'Step',
            text:'2.1-远程生成osw文件',
            name:'step_4_1',
            arrowArr:[
                {
                    arrow:'drawBottomToLeft',
                    to:'step_5_1'
                }
            ],
            x:'',
            y:'',
            requestData:{}
        },
        {
            type:'Step',
            text:'2.2-远程压缩获取osw文件',
            name:'step_4_2',
            arrowArr:[
                {
                    arrow:'drawBottomToLeft',
                    to:'step_5_1'
                }
            ]
        },
        {
            type:'Step',
            text:'2.3-本地解压osw文件',
            name:'step_4_3',
            arrowArr:[
                {
                    arrow:'drawBottomToRight',
                    to:'step_5_1'
                }
            ]
        },
        {
            type:'Step',
            text:'2.4-生成osw截图',
            name:'step_4_4',
            arrowArr:[
                {
                    arrow:'drawBottomToRight',
                    to:'step_5_1'
                }
            ]
        }
    ]
};

row4.data = calChartX(canWidth,row4.data, row4.y);

var flowData = [
    {
        row:1,
        y:init.top,
        data:[
            {
                type:'Start',
                text:'流程开始',
                name:'step_1_1',
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_2_1'
                    }
                ],
                x:canWidth/2,
                y:''
            }
        ]
    },
    {
        row:2,
        y:'',
        data:[
                {
                type:'Step',
                text:'1-获取alert和os日志',
                name:'step_2_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_3_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:3,
        y:'',
        data:[
                {
                type:'Step',
                text:'2-osw文件操作',
                name:'step_3_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_4_1'
                    },
                    {
                        arrow:'drawBottomToTop',
                        to:'step_4_2'
                    },
                    {
                        arrow:'drawBottomToTop',
                        to:'step_4_3'
                    },
                    {
                        arrow:'drawBottomToTop',
                        to:'step_4_4'
                    }
                ]
            }
        ]
    },
    {
        row:4,
        data:row4.data,
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:5,
        y:'',
        data:[
                {
                type:'Step',
                text:'3-oracle监控指标获取并写入excel表',
                name:'step_5_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_6_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:6,
        y:'',
        data:[
                {
                type:'Step',
                text:'4-osw图片写入到excel表',
                name:'step_6_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_7_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:7,
        y:'',
        data:[
                {
                type:'Step',
                text:'5-sqlserver图片写入到excel表',
                name:'step_7_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_8_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:8,
        y:'',
        data:[
                {
                type:'Step',
                text:'6-alert日志写入到excel表',
                name:'step_8_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_9_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:9,
        y:'',
        data:[
                {
                type:'Step',
                text:'7-os日志写入到excel表',
                name:'step_9_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_10_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:10,
        y:'',
        data:[
                {
                type:'Step',
                text:'8-alert日志错误检查',
                name:'step_10_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_11_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:11,
        y:'',
        data:[
                {
                type:'Step',
                text:'9-os日志错误检查',
                name:'step_11_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_12_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:12,
        y:'',
        data:[
                {
                type:'Step',
                text:'10-发送日报日志',
                name:'step_12_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:'step_13_1'
                    }
                ]
            }
        ],
        method:{
            onmousemove:null,
            onmouseleave:null,
            onclick:daily_check
        }
    },
    {
        row:12,
        y:'',
        data:[
                {
                type:'Step',
                text:'流程结束',
                name:'step_13_1',
                x:canWidth/2,
                arrowArr:[
                    {
                        arrow:'drawBottomToTop',
                        to:''
                    }
                ]
            }
        ]
    }
];

drawFlowChart(cxt,canvas,flowData, init.top, init.spaceH);

function daily_check(singleData){
    console.log("---------鼠标事件-----------");
    console.log(singleData);
    var btn_target = $(this);
        if(btn_target.hasClass('disabled')){
            common_ops.alert('正在处理，请不要重复点击！');
            return;
        }
    btn_target.addClass('disabled');
    var getdata = null;
    getdata = function(){
    $.ajax({
           url:common_ops.buildUrl("/dbinstall/"),
           type:"POST",
           dataType:"json",
           data:{
                tag:singleData.text
           },
           success:function (res){
               btn_target.removeClass('disabled');
               var callback = null;
               if(res.code == 200){

               }
                common_ops.alert(res.msg,callback);
           }
        });
    };
    common_ops.alert('是否要进行' + '“' + singleData.text + '”' + '操作？',getdata);
}
